datasource db {
  provider = "sqlite"
  url      = "file:data.sqlite3"
}

generator db {
  provider             = "prisma-client-py"
  interface            = "asyncio"
  recursive_type_depth = 5
}

model Post {
  id             Int      @id @default(autoincrement())
  source_id      String?
  source         String
  user           String
  created_at     DateTime
  fetched_at     DateTime
  url            String
  content_html   String
  content_txt    String
  content_search String?
  raw            String
  tags_assigned  Boolean  @default(false)
  is_hidden      Boolean  @default(false)
  tags           Tag[]    @relation("PostTags")
  iocs           IoC[]    @relation("PostIoCs")
}

model Tag {
  id    Int    @id @default(autoincrement())
  name  String @unique
  color String @default("#000")
  posts Post[] @relation("PostTags")
}

model IoC {
  id      Int     @id @default(autoincrement())
  type    String
  subtype String?
  value   String
  posts   Post[]  @relation("PostIoCs")

  @@unique([type, subtype, value])
}
